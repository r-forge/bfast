\documentclass[authoryear,preprint,review,10pt]{elsarticle}
\usepackage{amssymb,amsthm,amsmath,setspace}
\usepackage{url}
\usepackage[usenames,dvipsnames]{color}
\usepackage{lineno}
%\usepackage[labelfont=bf,format=hang,textfont=it]{caption}
\usepackage{graphicx}
\usepackage{microtype}
\usepackage[letterpaper,text={15cm,23cm}]{geometry}
\usepackage{natbib}
\usepackage{hyperref}
\usepackage{subfig}

%% for internal use
\newcommand{\fixme}[1]{\emph{\marginpar{FIXME} (#1)}}
\newcommand{\readme}[1]{\emph{\marginpar{README} (#1)}}

\definecolor{Red}{rgb}{0.5,0,0}
\definecolor{Blue}{rgb}{0,0,0.5}
\hypersetup{%
  pdftitle = {Real-time terrestrial ecosystem disturbance detection using satellite image time series},
  pdfsubject = {remote sensing, monitoring},
  pdfkeywords = {early warning, real-time, change detection, land cover change, deforestation, disturbance, NDVI, time series, MODIS, vegetation dynamics, phenology},
  pdfauthor = {Jan Verbesselt, Achim Zeileis, Martin Herold},
  %% change colorlinks to false for pretty printing
  colorlinks = {true},
  linkcolor = {Blue},
  citecolor = {Blue},
  urlcolor = {Red},
  hyperindex = {true},
  linktocpage = {true},
}


\journal{Global Change Biology}

\begin{document}
%% \linenumbers
\begin{frontmatter}

    \title
    {
    Real-time disturbance detection in terrestrial ecosystems \\ using satellite image time series \\
%    A case study for early warning of Drought in the Horn of Africa
    %real-time change detection using satellite image time series:
    %Early warning for forest disturbances
    % Real-time change detection of forest disturbances using satellite image time series
    }
    \author[WUR]{Jan Verbesselt\corref{cor}}
    \ead{Jan.Verbesselt@wur.nl}
    \author[UIBK]{Achim Zeileis}
    \ead{Achim.Zeileis@R-project.org}
    \author[WUR]{Martin Herold}
    \ead{Martin.Herold@wur.nl}
    \cortext[cor]{Corresponding author.}
    \address[WUR]{Remote Sensing Team, Wageningen University, \\
           Droevendaalsesteeg 3, Wageningen 6708 PB, The Netherlands}
    \address[UIBK]{Department of Statistics, Universit\"at Innsbruck \\
           Universit\"atsstr.~15, A-6020 Innsbruck, Austria}

\singlespace

\begin{abstract}

% satellite image time series are faster and faster available - methods to deal with this are lacking
Real-time monitoring of ecosystem disturbances is critical for addressing impacts on carbon storage, biodiversity, and socio-ecological processes. Satellite remote sensing enables cost-effective and accurate monitoring at frequent time steps over large areas. Yet, generic methods to detect disturbances within newly captured satellite images are lacking. 
We propose a generic time series analysis approach to detect disturbances within newly acquired data by automatically identifying a stable history period to model normal expected behaviour and as such enable detection of abnormal changes (e.g. drought, deforestation).

Time series of vegetation greenness provide evidence of terrestrial vegetation productivity over the last decades covering the whole world and therefore contain essential information related land cover dynamics and disturbances. Here, we assess and demonstrate the method by (1) simulating time series of vegetation greenness data from satellite data with different amount of noise, seasonality and disturbances representing a wide range of terrestrial ecosystems, (2) applying it to real satellite greenness image time series between February 2000 and July 2011 covering Somalia to  detect drought related vegetation disturbances.

Simulation results illustrate the proof-of-concept of the proposed real-time monitoring method. Disturbances are successfully detected in real-time, i.e., at the end of a time series, while being robust for seasonality and noise. However, the noise level of the time series remains the most important driver of capacity and timeliness to detect changes. 
Whereas the potential of the method has been illustrated for drought detection in Eastern Africa, it was developed as a generic multi-scale multi-purpose disturbance detection approach. Drought related disturbances were detected by restricting the analysis to areas with a minimum amount of vegetation cover and by requiring a minimum length of 2 years of the automatically detected stable history period. The method is able to identify drought effects and can be used as an early warning tool within an operation framework. Further work is needed for operational implementation of the method to enable a rapid response by applying it to time series data with a high temporal resolution (e.g., hourly or daily data).

%An homogenous region of drought related anomalies is detected in the South of Somalia illustrating the capacity of the method.  
The method is publicly available within the \emph{BFAST} package for {R} and can be used at a global scale since is fast, does not depend on vegetation type specific thresholds or definitions and does not require gap filling of time series. The method is flexible and can be applied for different purposes (e.g., deforestation, drought or fire or detection) and to different types time series data (e.g., climate data, in-situ monitoring sensors or different biophysical parameters derived from satellite image time series). 


%As such, data pre-processing in order to improve the quality and reliability of time series data remains essential to improve disturbance detection. 
% seasonality?
% noise?

\textbf{Research Highlights}
\begin{itemize}
    \item A novel near real-time time series based change detection approach.
    \item Validation by simulating time series and applying it on real satellite data.
    \item The approach is robust, fast, and flexible to different data sets and does not require gap filling or smoothing.
    \item The is freely available as a function in the \emph{BFAST} package for the open-source statistics system {R}.
\end{itemize}

\end{abstract}

\begin{keyword}
Early warning \sep global change \sep disturbance \sep time series \sep remote sensing \sep vegetation phenology \sep climate dynamics
\end{keyword}

\end{frontmatter} 

\section{Introduction}

% could we orient it more towards drought detection - so link it with the SMOS mission and a recent science paper. % the importance of detecting disturbances in real-time? 
% mention drought related problems - NDVI - rainfall link
%Real-time remote sensing approaches are already performed for weather monitoring and
%prediction \citep{Ebert:2007tj} (SMOS/MeteoSAT/ClimateDAta), and in case of after-disasters and relief efforts \citep{Tralli:2005ch}. 


Real-time ecosystem disturbance detecting is critical for tracking human-induced and natural disturbances promptly \citep{Asner:2011fa}. Such
information is needed for signalling abnormal developments, quickly raising awareness, and allow for prompt actions to intervene, relief efforts and reduce negative impacts to natural resources, humans, and infrastructure. Ecosystem disturbances can also contribute to the current rise of carbon dioxide ($CO_2$) levels in the atmosphere due to the emission of $CO_2$ from terrestrial biomass loss \citep{Potter2003,Schimel:2001vi}. 
Key to approaches looking at disturbances is that many recent change events occur worldwide at unknown locations. In this sense, remote sensing tools can be in the first instance used to alert when things start to appear \emph{abnormal}. For example, deviations from \emph{normal} land surface phenology, defined as the seasonal variation in vegetated land surface from remote sensing \citep{White2009}, can indicate important changes in forest health \citep{Stone2008,Verbesselt2009}, carbon status, regional drought effects and even climate change \citep{Cleland2007,Hargrove2009}.

% satellite data and vegetation indices
Satellite sensors are well-suited to provide consistent and frequent measurements over large areas which is appropriate for capturing the effects of many processes that cause disturbances, including physical (e.g. droughts, fires, floods), biogenic (e.g. herbivorous insects and pathogens) and anthropogenic (e.g. deforestation, urbanisation, farming) disturbances \citep{Jin2005, Potter2003}. A common way to derive indicators of environmental change is the use of spectral vegetation indices such as the Normalised Difference Vegetation Index (NDVI) that is strongly related to the photosynthetic capacity of vegetation canopies \citep{Myneni1995, Pettorelli:2005ed}. % fraction of photosynthetic active radiation (wavelength $0.4-0.7 \mu m$)

% different change types in ecosystem dynamics
Many types of ecosystem changes affecting the land surface range from diurnal cycles to long-term change in vegetation patterns. The ecosystem changes commonly observed with remote sensing approaches can be divided into three categories: (1)~\emph{seasonal or cyclic change}, driven by annual temperature and rainfall interactions impacting plant phenology resulting in distinct intra-annual patterns for different vegetation types; (2)~\emph{gradual trend change} such as trends in mean annual rainfall or gradual change in land management (e.g., forest regrowth after fire) that result in changes over several years; and (3)~\emph{abrupt trend change}, caused by events from human activities (e.g., deforestation) or natural causes (e.g., wind throw or an extreme drought event) that change land cover over short time frames (days or weeks) 
\citep{Beurs2005a,Verbesselt2009a,Verbesselt:2010wo}. 

%These changes can also be associated with two categories of land cover changes: conversion or modification. Conversion refers to a change from one cover type to another and might correspond to an abrupt change, whereas modification involves maintenance of the broad cover type in the face of changes in its attributes which can correspond to a gradual change \citep{vanLier:2011ga}. %These different types of changes commonly operate in parallel and approaches to detect and map a particular change type have to include information about the other types to avoid confusion and wrong labelling of change. 

% problem statement
Detecting changes within time series is the first step towards understanding the acting processes and drivers (e.g. natural or anthropogenic). Estimating change from remotely sensed data series however is not straightforward, since time series contain a combination of seasonal, gradual and abrupt ecosystem changes occurring in parallel, in addition to noise that originates from the sensing environment (e.g., view angle), remnant geometric errors, atmospheric scatter and cloud effects \citep{Beurs2005a, Roy2002, Wolfe1998}. The ability of any system to detect change depends on its capacity to differentiate normal phenological cycle from abnormal change (e.g., drought anomalies, degradation, deforestation). 
Several change detection methods are available to detect disturbances within historical satellite image time series \citep{deBeurs:2005jq, Verbesselt2009a, Verbesselt:2010wo, White2006} but generic methods to detect disturbances within newly captured satellite images are lacking. Three major challenges remain.

% changes at the end of a time series -(what is normal and what is abnormal can maybe be mentioned above?)
First, it is crucial to be able to detect disturbances within newly captured satellite images, i.e. in near real time to enable a rapid response or early warning. In previous work, we proposed a generic and threshold independent approach,  BFAST i.e. Break detection For Additive Seasonal and Trend, for change detection within seasonal time series \citep{Verbesselt2009a,Verbesselt:2010wo}.
BFAST detects and characterises trend and seasonal changes within historical time series but the method is not developed to detect disturbances in recently acquired data. Methods to detect changes in near real-time, also referred to as monitoring techniques, have been suggested in the econometrics literature to assess the stability of linear regression models \citep{Chu1996}, e.g., for investigating exchange rate dynamics \citep{Zeileis:2010tt}. These method have not been optimised for real-time disturbance detection of terrestrial ecosystems using remotely sensed time series data.

% threshold independent
Second, change detection techniques for global disturbance monitoring need to be independent of vegetation-specific thresholds while being robust against the inherent noise and seasonality captured within time series.
Most change detection methods require user designation of a threshold or change type definition separating real change from spectral changes caused by variability in illumination, seasonality, or atmospheric scattering \citep{Lu2004, Potter2003}.  \citet{White2006} presented a method for real-time monitoring but requires a region-specific threshold for detecting change. The determination of thresholds adds significant cost to efforts expanding change detection across regions or becomes complex when the regions are changing. 
Trajectory-based change detection has been proposed to move towards a threshold-independent change detection by characterising change by its temporal
signature \citep{Hayes2007, Kennedy2007}. This approach requires the definition of the change trajectory specific to the type of change to be detected, is computing intensive, and will only function if the observed spectral trajectory matches one of the hypothesised trajectories. 
A historical analysis using archived satellite data is needed to model normal, expected behaviour against which abnormal behaviour, i.e. disturbance, in the near
future can be described \citep{Hargrove2009}. This illustrates the critical need to enable analysis of time series independent of vegetation specific thresholds or trajectory definitions to detect disturbances.

% missing data: avoid smoothing and interpolation
Third, change detection methods need to deal with missing data (e.g., clouds or sensor defects) in time series data.
Most existing change detection methods smooth or fill gaps using one of many existing techniques (e.g., filtering, Fourier analysis)  \citep{Jonsson2002, Roerink2000, Julien2010} when dealing with noisy times series of remotely sensed data. For a given date, these methods typically require looking both backwards and forwards in time, negating use in real-time or forecast applications \citep{White2006}.  Also, gap filling techniques model data based on assumptions of normal data variation which inhibits the detection of disturbances \citep{Samanta:2011hp}. Therefore, methods able to analyse and detect changes in non-gap-filled time series are critical for global change monitoring.

We propose a generic approach for real-time change detection of disturbances using time series data that does not require specific thresholds and deals with missing data. The following major research questions are answered in this paper: \\
(1)~Can a period, representing \emph{normal} historical data variation representing both seasonal and gradual changes, be identified within a time series?\\
(2)~Is the model representing the \emph{normal} historical data variation able to reliably and quickly differentiate between normal and abnormal changes (i.e. disturbances) within newly incoming observations (i.e., real-time)?

We assessed this approach for different ecosystems by simulating NDVI time series with varying amounts of seasonal
variation and noise, and by adding changes with different magnitudes.  We demonstrated the proof-of-concept using the MODIS (Moderate Resolution Imaging Spectrometer) NDVI 16-day image composites from February 2000 until July 2011 for automated drought disturbance detection in Somalia and a fire disturbance monitoring in Victoria, Australia. The severe drought occurring in Somalia (2010-2011) is selected as a case study to demonstrate the characteristics of the method. The method is a generic approach to automatically detect disturbances by analysing time series of biophysical indicators at a global scale. Here we opted for the NDVI, as a common measure of vegetation dynamics and disturbances \citep{Pettorelli:2005ed, Potter2003, Myneni:1997ur}. Whereas more region specific drought monitoring methods are available \citep[][]{Funk:2009vf, Verbesselt2006}, current method can also be applied on optimised drought related indices \citep{Ghulam:2007td}. 

\section{Real-time disturbance detection}\label{sec:Method}

While \citet{Verbesselt:2010wo} focussed on the question if and where disturbances occur in the season and trend component of a given observed time series $t = 1, \dots, n$, we want to investigate a different question: \emph{Do new observations $t = n, n + 1, \dots$ still conform with the normal expected behaviour of the historical sample $t = 1, \dots, n$}~? Thus, we want to detect disturbances at the end of a time series by comparison with representative, i.e. stable, historical observations.
A method is presented below that is able to detect disturbances within newly acquired time series data by automatically identifying a stable history period (Section \ref{sec:StableHist}) to model normal expected behaviour (Section \ref{sec:seasontrendmodel}) against which disturbances can be detected (Section \ref{sec:MonStrucChange}).

%The methods proposed here are based on a similar additive season and trend
%model as employed by \citet{Verbesselt:2010wo}. However, while
%\citet{Verbesselt:2010wo} focussed on the question if and where structural breaks occur in the season and trend component of a given observed time series
%$t = 1, \dots, n$, we want to investigate a different question:
%\emph{Does the season-trend model for future observations $t = n, n + 1, \dots$ still
%conform with the season-trend model established for the historical sample
%$t = 1, \dots, n$}~? Thus, we want to monitor potential abnormality at the end of a time series, in
%real-time, by comparing it with historical observations.

\subsection{Season-trend model}\label{sec:seasontrendmodel}

The method proposed here is based on a similar additive season and trend model as employed by \citet{Verbesselt:2010wo} to account seasonal and trend changes typically occurring within climate driven biophysical indicators derived from satellite data (e.g. NDVI)  \citep{Beurs2005a}. For the observations $y_t$ at time $t$, a season-trend model is assumed with linear
trend and harmonic season:
%
\begin{align} \label{eq:lmod}
  y_t & = \alpha_1 + \alpha_2 t + \sum_{j = 1}^k \gamma_{j} \sin \left(\frac{2\pi j t}{f} + \delta_{j} \right) ~+~ \varepsilon_t,
\end{align}
%
where the intercept $\alpha_1$, slope $\alpha_2$ (i.e., trend), amplitudes $\gamma_1, \dots, \gamma_k$,
and phases $\delta_1, \dots, \delta_k$ (i.e., season) are the unknown parameters,
$f$ is the known frequency (e.g., $f = 23$ annual observations for a 16-day time series),
and $\varepsilon_t$ is the unobservable error term at time $t$. In the applications
below, we employ three harmonic terms (i.e., $k = 3$) to robustly detect disturbances within MODIS NDVI time series, as components four and higher represent variations
that occur on a three-month cycle or less \citep{Geerken2009,Julien2010}. The model (Eq. \ref{eq:lmod}) can be written as standard a linear regression model \citep[see e.g.,][Chapter~3.3]{Cryer2008}:
%
\begin{align*} \label{eq:OLSlmod}
  y_t   & = x_t^\top \beta ~+~ \varepsilon_t, \\
  x_t   & = \left\{1, t, \sin(2 \pi 1 t / f), \cos(2 \pi 1 t / f),
              \dots, \sin(2 \pi k t / f), \sin(2 \pi k t / f)\right\}^\top, \\
  \beta & = \left\{\alpha_1, \alpha_2, \gamma_1 \cos(\delta_1), \gamma_1 \sin(\delta_1),
              \dots, \gamma_k \cos(\delta_k), \gamma_k \sin(\delta_k)\right\}^\top,
\end{align*}
%
containing the $p = 2 + 2 k$ regression parameters $\beta$ which can be estimated and tested using ordinary least squares (OLS) techniques. 

\subsection{Monitoring structural change}\label{sec:MonStrucChange}

Based on the season-trend model introduced above, the question raised in
the introduction can be rephrased: \emph{Given that a stable season-trend model was estimated in an observed
time period, does it remain stable for new observations?} A disturbance is detected when the model does not remain stable for new incoming observations.
As the season-trend model can be formulated as an OLS regression,
we can leverage from the methods proposed in the structural change literature
for linear regression models where this problem is known as \emph{monitoring}
of structural changes \citep{Chu1996}.
The idea for monitoring techniques is simple. Given that the parameters
$\beta$ can be consistently estimated as $\hat \beta$ from a stable history
period $t = 1, \dots, n$, we want to check whether $\hat \beta$ still fits
the data $y_t$ for $t > n$ (i.e. for new data). To do so, some measure of discrepancy is needed \citep[][]{Chu1996, Leisch2000, Zeileis2005a}. Here, we use moving sums (MOSUMs) of the residuals in the monitoring
period $t = n + 1, \dots, N$:
%
\begin{align}
  m_t & = \frac{1}{\hat \sigma \sqrt{n}} \sum_{s = t - h + 1}^t (y_s - x_s^\top \hat \beta),
\end{align}
%
where $h$ is the bandwidth of the MOSUM and is typically chosen relative to
the size of the history sample, e.g., $h = n/4$ or $h = n$ \citep{Zeileis2005a, Zeileis:2010tt}.
If the model remains stable, the MOSUM process $m_t$ should be close to zero and
fluctuate only randomly. However, if a structural change occurs, $m_t$ will deviate
systematically from zero. A structural break is declared if the absolute value
$|m_t|$ exceeds some boundary that is asymptotically only crossed with 5\%
probability under structural stability. The technical details for the boundary are based
on a so called functional central limit theorem \citep[see][for details]{Leisch2000}.

% Here, we use the boundary function $c \sqrt{2 \log_+ t/n}$, where $\log_+ x$ is $1$ for $x \le e$ and $\log x$ otherwise and $c$ is the critical value that determines the significance level. The critical values also depends on the choice of $h$ and the monitoring horizon $N$, e.g., for $h = 0.25 n$ and $N = 10 n$, $c = 1.3409$ at the 5\% level.

\subsection{Selecting the stable history period}\label{sec:StableHist}

A crucial assumption for the monitoring approach proposed above is that
the history period $t = 1, \dots, n$ itself is free of disturbances, that the parameters $\beta$ are stable during this time, and can be used to model normal expected behaviour. In practice, there are often long series of observations $y_t$ available
before the start of the monitoring process and it would be naive to assume
that always all of these observations can be adequately captured by a single
season-trend model. Hence, a natural idea is to not use all observations
but only the last $d, \dots, n$ observations with $d \ge 1$ so that a stable
season-trend model can be fitted. 
Here, we implement a technique proposed by \citet{Pesaran2002} that by moving backward in time for $t = n, n-1, n-2, \dots$ considers a cumulative prediction error until the season-trend model (Eq. \ref{eq:lmod}) breaks down. The method is also known as reversed-ordered-cumulative sum (CUSUM) of residuals, or ROC. The ROC method is based on similar ideas as the monitoring approach introduced
above, but in reverse ordering \citep[see][for more details]{Zeileis2002}.

Fig.~\ref{fig:SimMonitor} provides an overview of the three steps that are being performed when applying the real-time disturbance detection approach. 
Two periods are defined within a time series; (a) a \emph{history period} i.e., data that already has been acquired and which will be analysed for stability in order to model normal vegetation dynamics, and (b) a \emph{monitoring period} i.e., the period representing new data that recently has been captured that needs to be analysed for disturbances. The blue line illustrates the fit of the seasonal-trend model on the identified stable part of the history period of a example NDVI time series (Section \ref{sec:seasontrendmodel} and  \ref{sec:StableHist})). This seasonal-trend fit is used to model the normal expected behaviour in the \emph{history period} and as such detect abnormal data variations, disturbances, within the \emph{monitoring period} (Section \ref{sec:MonStrucChange}) . Here, a disturbance is detected.

%In summary, when applying the real-time disturbance approach three steps are being performed: (1) verify which part of the history period is stable (Section \ref{sec:StableHist}), (2) fit the seasonal-trend model on the stable history period (Section \ref{sec:seasontrendmodel}) and (3) assess whether the stable history model is still valid for the new incoming data (Section \ref{sec:MonStrucChange}, i.e. disturbance detection).

\section{Validation}\label{sec:Validation}

We validated the real-time change detection approach by (1)~a simulation experiment and (2)~analysis of 16-day MODIS satellite NDVI time series. Validation of multi-temporal change-detection methods is often not straightforward, since independent reference sources for a broad range of potential changes must be available \citep{Kennedy2007}.
We simulated 16-day NDVI time series with different noise levels, seasonality, and disturbances in order to robustly test the real-time change detection approach in a controlled environment.  A similar validation strategy was proposed by \citet{Verbesselt2009a, Verbesselt:2010wo} to validate the detection of phenological shifts, abrupt and gradual changes within time series. Here, we focus on the validation of disturbance detection at the end of a time series, i.e. in real-time. In the next two sections, the simulation of NDVI time series and application on real MODIS NDVI satellite image time series are explained. 

\subsection{Simulation experiment}\label{sec:Valsim}

The objective of the time series simulation experiment was to assess the \emph{detection delay}, i.e. how much new data is required to detect a disturbance, while varying the amount of noise, seasonal amplitude, and the magnitude of the disturbance in the simulated time series. NDVI time series were simulated using a similar approach as proposed by  \citet{Verbesselt:2010wo} representing a wide range ecosystem dynamics. Simulated NDVI time series are generated by summing individually simulated seasonal, trend, and noise components (Fig.~\ref{fig:SimMonitor}). 

First, the seasonal component is created using an asymmetric Gaussian function with a amplitude ($a$) for each season. Second, an disturbance was added to the trend component (e.g., fire or drought) by combining a step function with a magnitude ($m$) and fixed gradient recovery phase. Third, the noise component was generated using a random number generator that follows a normal distribution N($\mu = 0$, $\sigma =x$). Vegetation index specific noise was generated by randomly replacing the white noise by noise with a value of $-0.1$, representing cloud contamination that often remains after atmospheric correction and cloud masking procedures \citep[see][for more details]{Verbesselt:2010wo}. Fig.~\ref{fig:SimMonitor} shows a simulated 16-day MODIS NDVI time series with $a$ = 0.2, $\sigma$ = 0.05, containing one simulated abrupt change with $m$ = $-$0.3) (Table~\ref{table:simpar}).

In the simulation experiment the \emph{history period} is defined as the period from 2000 until mid 2006 (i.e., the time step just before the simulated break), whereas the \emph{monitoring period} is defined as the period from the simulated break onwards of which the length is gradually increased during the experiment ($d$) (Fig.~\ref{fig:SimMonitor} and Table~\ref{table:simpar}). We selected a range of $a$, $\sigma$, and $m$ values for the simulation study to represent a large range of land cover types of different data quality while varying the amount of data, $d$, available in the monitoring period (Table~\ref{table:simpar}). An example of the set-up of the simulation experiment is shown in Fig.~\ref{fig:SimMonitor}. 1000 iterations of all the combinations of $\sigma$, $a$, $d$ and $m$ were performed to quantify the probability of detecting a disturbance in the monitoring period in relation to the amount of data available ($d$).

\begin{table}[htb]
\caption{Parameter values ($a$, $\sigma$ noise and $m$) for simulation of 16-day NDVI time series while varying the amount of data available in the monitoring period ($d$, 16-day time steps units) to quantify the detection delay.}
\centering
\begin{tabular}{ll}
  \hline
  Parameters & Values \\ [0.5ex]
  \hline
  $a$         & $0.1, 0.3, 0.5$ \\
  $\sigma$ noise    & $0.01,0.02,\dots,0.15$ \\
  $m$         & $0, -0.2, -0.4, \dots, -0.8$ \\
  $d$   & $1, 2, \dots, 6$ \\ [.5ex]
  \hline
\end{tabular}
\label{table:simpar}
\end{table}

%Two periods are defined within the simulated time series to validate the real-time monitoring approach; (a) a \emph{history period} i.e., data that already has been acquired and which will be analysed for stability in order to model normal vegetation dynamics, and (b) a \emph{monitoring period} i.e., the period representing new data that recently has been captured that needs to be analysed for disturbances. 

\subsection{Spatial application on MODIS 16-day NDVI time series}\label{sec:RealData}

The use of the real-time monitoring approach is demonstrated using the 16-day MODIS NDVI composites with a 5.6~km spatial resolution (MOD13C1 collection~5). This product provides  NDVI corrected for the effect of atmospheric gases, thin cirrus clouds and aerosols as a proxy for global scale vegetation dynamics and disturbances \citep{Huete2002}.
The MOD13C1 global satellite images were acquired from February 2000 to July 2011 and were analysed for disturbances from mid 2010 onwards covering Somalia in order to assess the impact of the 2010--2011 drought on the vegetation photosynthetic capacity. 

\readme{illustrate main land cover types using the MODIS IGBP land cover classification maps and illustrate climate data trends to confirm drought effect in Eastern Africa - maybe add some climate/topography info about study area -- this is important if we go for a full Global change biology paper}

The MODIS quality assurance (QA) flags is used to select only cloud-free data of optimal quality. A NDVI time series is only analyzed when either (1) it lacked less than 15\% of observations masked out by the QA flags and (2) covering vegetated land; i.e. having a median of NDVI time series larger than 0.2 NDVI \citep{Beurs2009}. The noise level ($\sigma$) of NDVI time series is estimated by deriving the standard deviation of the residuals from the fitted seasonal-trend model (Eq. \ref{eq:lmod}) on the stable history period.  The magnitude and direction of the disturbance is estimated by deriving the difference between the median of fitted seasonal-trend model and new observations during the monitoring period.

\section{Results and discussion}

\subsection{Simulation experiment} \label{sec:DiscSim}

Fig.~\ref{fig:SimNr} illustrates the probability for detecting a break within the monitoring period of a time series while varying the noise level ($\sigma$), magnitude of simulated disturbance ($m$) and the amount of data available in the monitoring period ($d$). The seasonal amplitude ($a$) did not influence the probability for break detection and results shown in Fig.~\ref{fig:SimNr}  are valid for the different simulated $a$'s (Table~\ref{table:simpar}). The length of the identified stable history period also did not influence the probability for break detection (results not shown). Random and NDVI specific noise levels were introduced to simulate disturbances in the history period of the simulated time series and trigger identification of stable history periods with different lengths. We, however, recommend limiting the disturbance detection in time series with a stable history period longer than 2 years (i.e. 46 observations representing two seasons in this study) to enable a reliable estimation of the 8 seasonal-trend model parameters. 

Furthermore, Fig.~\ref{fig:SimNr} shows that a break with $m = -0.4$ can be detected when $\sigma$ is smaller than 0.1 and $d < 3$.  When the magnitude of the break is larger (e.g., $m = -0.6$), less observations ($d<4$) are required for a similar amount of noise (e.g., $\sigma < 0.1$). Three items can already be discussed; (1) advantages and disadvantages of simulating data and (2) the purpose of this method.

%Fig.~\ref{fig:SimNr} showed that noise level ($\sigma$), available data in the monitoring period ($d$), and the magnitude ($m$) of the simulated disturbance are the drivers of the probability to detect disturbances (Fig.~\ref{fig:SimNr}). As such, the disturbance detection probability can be determined by deriving the noise level in real time series data of which timing and magnitude of disturbance and available data ($d$) during the disturbance is unknown. See Fig. Noise and Section X for further discussion.

\begin{enumerate}[(1)]

% noise level noise levels as a driver of disturbance detection probability
% importance of the simulation experiment
\item Results confirm the importance of a simulation experiment when developing global change detection methods. Novel methods can be tested in a controlled environment while varying individual parameters. When detecting changes in real data at a global scale often accurate field data about disturbances and influencing factors (e.g. quality of the time series observations) are not available. However, it is challenging to create simulated time series that approximate remotely sensed time series, because these contain combined information on vegetation phenology, inter-annual climate variability, disturbance events, sensor conditions (e.g., viewing angle), and signal contamination (e.g., clouds) \citep{Zhang2009}. For example, it is important to assess the effect of inter-yearly seasonal shifts in real satellite data (e.g. shifts in the growing season) as these can increase the $\sigma$ and reduce the probability of disturbance detection. The inter-yearly seasonal variation is especially high in grasslands, savannah regions with a high herbaceous cover fraction and unpredictable rainfall. The effect of inter-yearly seasonal variations have been simulated in this experiment by introducing high $\sigma$ levels (i.e. up to 0.15 $\sigma$, Table~\ref{table:simpar}).

In previous work it was shown that seasonal amplitude and shifts are relatively small in forested areas when compared to grassland areas \citep{Verbesselt:2010wo}. Therefore, the generic disturbance detection approach has a higher accuracy, i.e. disturbances with a smaller magnitude can be detected faster as shown in Fig.~\ref{fig:SimNr}, in forest ecosystems. For example, the real-time monitoring approach can be implemented in an operational framework for deforestation monitoring to complement existing systems such as the Brazilian deforestation monitoring system \citep[DETER,][]{Shimabukuro:2006vb} or \citep[CLASLITE,][]{Asner:2009wa} or as an independent alert system in other regions in the world (e.g., Indonesia, Vietnam) where real-time monitoring systems are not implemented yet\citep{Asner:2011fa}. An the other hand, drought related anomalies often cause major disturbances (e.g. magnitudes $> 0.4$ NDVI) in herbaceous ecosystems (i.e. large variations in NDVI) which enables disturbance detection in highly variable ecosystems (see Section \ref{sec:DiscReal}).

%% warning: the seasonal amplitude has not effect but this is partly because we did not simulate seasonal shifts - seasonal shifts were partly accounted for by the extreme high simulated noise levels. %Grasslands, for example, demonstrate large inter-yearly seasonal variation caused by a early or late start/end of the growing season which is more difficult to be fitted within multi-year time series data. This is illustrated by the higher noise levels (i.e., standard deviation of the residuals of the season-trend model used in this study) in the grasslands surrounding the forest plantations. 

% important to be discussed - here the seasonality has no influence since the seasonal-trend model is perfectly able to account for the simulated seasonal variation. However, in reality especially in ecosystems with a large inter-yearly variation in seasonality (e.g. late or early start of the growing season) these models have difficulties accounting for these phenological shifts. This, again, illustrates the importance of applying the method to real MODIS data in an area where there is a high probability of inter-yearly variation in seasonality due to unpredictable rainfall patterns (add reference). However, when applying the method in a forested environment we will illustrate that there is often is a small seasonal variation due the saturation of the NDVI signal and deeper rooting systems of forests which makes them more resistant to local climate variability. Here noise levels are smaller and therefore the method will be able to detect smaller disturbances faster (i.e. small detection delay)

\item The accuracy of estimating the time of disturbance was not assessed in the simulation experiment. The proposed method is developed as a fast, generic and globally applicable alert system for disturbances within newly acquired data of available time series observations. In previous work, the BFAST method was proposed to determine the number, type, and timing of trend and seasonal changes within historical time series \citep{Verbesselt2009a} whereas, here, we focussed on disturbance detection in newly acquired observations. A possible operational workflow for disturbance monitoring could be to (a) verify whether or not a disturbance is occurring in new observations using the method proposed here and then (b) if a disturbance is detected the timing, magnitude and direction of change can be determined when more data is available.  Similarly, the accuracy of the stable history duration was not assessed. The validated ROC approach \citep{Pesaran2002, Zeileis2002} was used here as an automated approach to identify a history period without disturbances and is not developed for time estimation of disturbances in the history period. Again, in a second phase the BFAST approach can be used for a more accurate time of disturbance estimation. Alternatively, when expert knowledge is available the stable history period can manually be set but is not recommended for regional or global scale analysis due to a loss in flexibility. This functionality is available in the real-time monitoring function available in the \emph{BFAST} package for {R} \citep{R}.
 
%In summary, the length of the stable history as such can be used to optimise the real-time change detection approach depending on the objectives of operational real-time disturbance system.

\end{enumerate}

% what is not tested here is that when a disturbance occurs later in the monitoring period the probability to detect disturbance is influenced...
% the delay time for disturbance detection is important!!! (how fast can a change be detected?)
% to do search for a forest in Somalia - i.e. high median NDVI - in order to illustrate this concept - when can also illustrate this for a pixel modis MOD13C1 for a fire in Victoria (coordinates -> query from the database - and plot an example).

\subsection{Spatial application on MODIS 16-day NDVI time series} \label{sec:DiscReal}

While the data and methods used here are appropriate for proof-of-concept development for global scale disturbance monitoring, specific applications (e.g., drought or deforestation monitoring) will mandate use of optimize indicators or integration within an operational monitoring framework. For example, specialized climate- and satellite data based indices have been developed for drought monitoring \citep[e.g.][]{Funk:2009vf}. Here, however, we demonstrate how the method can be used as a near real-time disturbance detection method by analyzing MODIS 16-day NDVI image time series as a proxy for spatio-temporal dynamics of the vegetation photosynthetic capacity. The disturbance detection was limited to areas (1) with a minimum amount of vegetation cover by restricting the analysis to time series with a median NDVI $>0.2$ during the 2000--2011 period \citep{Beurs2009}, (2) with a stable history longer than two years (see Section \ref{sec:DiscSim}).

\readme{this corresponds roughly to the IGBP land cover classification}

\begin{enumerate}[(1)]

\item Fig. \ref{fig:spatiala} illustrates the median of a NDVI image time series (2000-2011) as a proxy for vegetation cover during the period of analysis. Areas with no or very low vegetation cover are occurring in the North East of Somalia whereas areas with higher vegetation cover are situated in the South of Somalia. 

The NDVI time series with no or very low NDVI values do not show any seasonal climate related vegetation dynamics and are mainly influenced by irregular variations in soil properties. The analysis was restricted to areas with a median NDVI time series larger 0.2 NDVI to reduce influence from soil back ground and focus on assessing the impact of the drought effects on the vegetation photosynthetic capacity. Other vegetation indices (e.g. SAVI) exist which reduce influence from soil back ground \citep{Huete2002}, however, here we analyzed NDVI time series as a proxy for global dynamics of photosynthetic capacity \citep{Myneni1995}.

\item Fig. \ref{fig:spatialb} illustrates the spatial variation of the length of the stable history period and is used to restrict the analysis to regions with a stable history longer than 2 years. The stable history is identified for modeling normal variation within the history period to enable differentiation from abnormal changes, i.e. disturbances, in the monitoring period (i.e. mid 2010 onwards). It is does not accurately determine  the time of change but verifies whether or not a structural change is occurring while stepwise going back in history \citep{Zeileis2002}. The length of the stable history (Fig. \ref{fig:spatialb}) could be used as an approximation of the occurrence of the most recent major disturbance in the history period but more appropriate structural change detection method are available to accurately determine the time of change \citep{Bai2003, Verbesselt2009a}. Analysed NDVI time series for specific locations are shown in Fig.~\ref{fig:realmon} where for time series in Fig.~\ref{fig:realmon}a and c the whole history period and in Fig.~\ref{fig:realmon}b a shorter stable history period is identified as stable. The short history period in Fig.~\ref{fig:realmon}c can be explain by a lack of rainfall in 2007--2008 \citep{Funk:2009vf}. \readme{add climate data}

\readme{Double check the detection delay discussion}
%The BFAST approach is developed to accurately estimate time, magnitude, and direction of change within historical time series but it is not developed to detect disturbances in new observations (i.e. near real-time monitoring) . 
%The method for identifying the stable history is based on the structural change detection methods \citep{,Zeileis:2010tt} and is implemented to assess stability of the history period. 

\end{enumerate}

Fig.~\ref{fig:spatialc} shows the spatial variation of the noise level (i.e. $\sigma$ of the residuals of the seasonal-trend model) where low $\sigma$ correspond to the low vegetated areas or forested areas and the high $\sigma$ correspond to the semi-arid ecosystems (e.g. woodland and savannah). High $\sigma$  in the semi-arid ecosystems can be explained by large inter-annual phenological shifts (e.g., shifts in the start and end of the growing season) when compared to areas with low vegetation cover or forests \citep{Verbesselt:2010wo}. Forest ecosystem when compared to semi-arid ecosystems (herbaceous land cover types) are more resistant against seasonal climate variations in rainfall and temperature due to the deeper rooting system \citep{Verbesselt2006}. 

Fig.~\ref{fig:spatialc} also illustrates that the noise range, 0--0.15, corresponds to the noise range of the simulation experiment (Fig.~\ref{fig:SimNr}) which confirms that the range of terrestrial ecosystem NDVI dynamics occurring in the study area were appropriately simulated for testing the proposed method in a controlled environment. Furthermore, the noise range shown in Fig.~\ref{fig:spatialc} can be used when interpreting Fig.~\ref{fig:spatiald}, since the simulation experiment  (Fig.~\ref{fig:SimNr}) illustrated that $\sigma$ is one of the main drivers of the probability to detect disturbance. Fig.~\ref{fig:spatiald} shows the magnitude of the detected disturbances in the monitoring period where the magnitude of change is estimated by comparing the new observation with the prediction of the fitted seasonal-trend model. Once more data is available other approaches should be used for a more accurate change magnitude estimation \citep[e.g. BFAST][]{Verbesselt2009a}. Disturbances with negative magnitudes are detected and illustrate the effect of the 2010--2011 drought on vegetation photosynthetic capacity as measured by the NDVI in Somalia and surrounding countries \citep{Funk:2011fg}. The detected disturbances occur in areas with higher noise level are having large magnitudes which is confirmed by the simulation experiment (see Fig.~\ref{fig:SimNr} when $m> -0.2$ NDVI at $\sigma>0.1$ and $d>4$).

Only negative disturbances are occurring in Somalia and surrounding countries illustrating the effect of the ongoing drought on vegetation photosynthetic capacity (over different land cover types). Fig.~\ref{fig:realmon}a and b illustrate to examples of a time series where a disturbance is detected in the monitoring period. The negative magnitude is clearly shown by the lack of seasonality and major decrease from 2010 onwards .
Drought effect of vegetation is one of the factors contributing the current ongoing famine in the Horn of Africa but is certainly not the only one. Other factors such as political instability, lack of infrastructure, and long term planning are also contributing to the famine \citep{Funk:2011fg}.


% Drought effect is mainly occurring in the South East of Somalia... which is one of the hot-spots of the current famine.
% dit toont aan wat het huidige effect is van de droogte op alle vegetatie types in Somalia (niet alleen agriculture). 

%The magnitude levels of the disturbances detected in Fig. x d are lower due to a difference in the method to determine the magnitude of change in the simulation experiment (magnitude of the introduced step-change) and the real data (See section X).  Fig. c and d illustrate together noise levels and areas of detected changes

%The proposed real-time monitoring could be further improved by; (a)~including other explanatory variables in the monitoring model (e.g., temperature, rainfall)
%which will contribute to model the data and determine what is normal versus what is abnormal (GAM modelling references), (b)~determining the magnitude and direction of change from the fitted parameters of seasonal-trend model \citep{Verbesselt2009a} and (c)~the monitoring model proposed here can also be used as a forecasting model. Similar to current real-time monitoring approach, forecasting requires a profound understanding of vegetation dynamics and vegetation interaction with the atmosphere, combined with proper data analysis techniques  \citep{LeiJi:2004kx}.

% discuss that the stable history period detection is a rough measure for stability assessment - and can be further improved to be more sensitive to seasonal changes e.g. by combining different score based function instead of just one, the MOSUM criteria applied here. % the objective of the paper here is to propose, assess, and demonstrate a novel approach for global disturbance assessment. Further improvement is possibles and we recommend especially further field data based validation in case the method is applied to detect specific disturbances.

\section{Conclusion}

Currently, real-time satellite images are routinely produced and published on the World wide Web (e.g., \url{http://rapidfire.sci.gsfc.nasa.gov/} or \url{http://www.dmcii.com/index.html}) but methods for real-time monitoring and change detection are lacking. Here, we propose a time series based real-time monitoring approach that enables the detection of disturbances within a wide range of terrestrial ecosystem.

The method has been validated (1) in a controlled environment by simulating time series containing disturbances and (2) by applying it to MODIS NDVI image time series covering Somalia. Results from the simulation experiment demonstrate that the noise level within the time series and the the amount of data available in the monitoring period are the main drivers of the capacity to detect disturbances. 

Major negative disturbances are detected using 16-day NDVI image time series as a proxy for the the photosynthetic capacity of terrestrial ecosystems. This illustrates the proof-of-concept of the proposed method as a near-real time disturbance detection system which could be integrated in existing early warning systems for drought anomaly monitoring. Other climate and satellite derived indices developed for drought anomaly monitoring could also be used as an input in the disturbance detection method. 

%Application on 16-day MODIS NDVI time series for drought anomaly detection of the photosynthetic capacity of terrestrial ecosystems in Eastern Africa, Somalia illustrate a proof-of-concept of the proposed time series based real-time monitoring approach. 

% positive and negative disturbance are being detected...

%The results illustrate that major disturbances can be detected in ecosystems characterised by a large yearly seasonal variation (e.g. savannah or woodlands) whereas the disturbance detection is more accurate in more stable ecosystems with a small seasonal variaton (i.e. forests)

% application is better in forest ecosystem but drought anomaly detect is possible but only major disturbance can be detected.
%Land cover types with a dominant herbaceous cover have a high seasonal amplitude together with large inter-yearly phenological shifts.

The approach is a generic based on statistical principles applicable to different types of time series (e.g., in-situ or satellite sensors). The method can be applied to time series with a higher temporal resolution (e.g., hourly, daily or 8-day time series) to enable rapid response to detected disturbances. The method has the following characteristics that make it appropriate for real-time change detection implementation at different spatial scales. The method
(1)~is fast and require a minimum a mount of processing time (e.g., 0.04 seconds to analyse 10 year long 16-day time series  on a normal desktop computer),
(2)~does not require the definition of thresholds, (3)~can analyse time series with data gaps (e.g., masked clouds or sensor defects) and does not require gap filling techniques, and 4) it analyses the full temporal detail of a time series. Furthermore, the real-time monitoring method is implement in open-source software environment and is freely available on \url{http://bfast.R-Forge.R-project.org/} . The methods are available in the \emph{BFAST} package for {R} \citep{R} from the Comprehensive {R} Archive Network (CRAN) at \url{http://CRAN.R-project.org/package=bfast}.


%It can be used for disturbance detection within other data sets (e.g. temperature, rainfall, $CO_2$ time series data) or be integrated within monitoring
%frameworks (e.g., \url{http://rapidfire.sci.gsfc.nasa.gov/}), and used as an alarm system to provide information on when and where
%significant disturbances occur. 

%Thevalidation approach by combining tests with simulated and real data should be a standard practice when validating novel change detection approaches. Furthermore, methods being proposed should also be made available to other scientist enabling the reproducibility of the research and collaboration towards further improvement of the methods.

%The approach is adaptable to different remote sensing technologies and provides a foundation for ascribing a sequence of ground conditions (e.g., snowmelt, vegetative growth, pollen production, insect phenology) to remotely sensed land surface phenology observations \citep{White2006}.

%Deviations from normal land surface phenological development can be the first indications of important changes in forest health, including disturbance and recovery, carbon status, and even climatic shifts.

\section{Acknowledgements}

This work was undertaken using expertise and field data available via the program of the Cooperative Research Center for Forestry: Monitoring and Measuring (\url{http://www.crcforestry.com.au}). This work was funded by a Marie-Curie IRG fellowship within the European Community's Seventh Framework Program to Jan Verbesselt (grant agreement $268423$). Thanks to Darius Culvenor and Glenn Newnham whose comments greatly improved this paper. We greatly appreciate the constructive feedback we have received from the x reviewers.


\bibliographystyle{gcb} % Global Change Biology Style Sheet!!!!
\bibliography{refs}

\newpage

\section*{Figures}

 (For interpretation of the references to color in this figure legend, the reader is referred to the web
 version of this article.)

 \begin{figure}[htp]
\centering
    \includegraphics[width=0.8\textwidth]{figs/Sim_Monitoring_ggplot.eps}
  \caption{Simulated 16-day MODIS NDVI time series with $a$ = 0.4, $\sigma$ = 0.05, containing one simulated abrupt change with $m$ = $-$0.3). The period from 2004 until mid 2010 (i.e., the time step just before the simulated break), is considered the \emph{history period} and the period after the simulated break is the \emph{monitoring period} (grey background). The monitoring period contains 6 observations  ($d$ = 6, \textcolor{red} {red dotted} line). The result of the monitoring approach are shown. A stable history period is identified within the history period (i.e. 2007 until mid 2010) and used to model and predict the normal data variation (\textcolor{blue} {blue} dashed line) to enable disturbance detection (Section~\ref{sec:MonStrucChange}).  Here, a disturbance is detected (\textcolor{OliveGreen} {green} line).}
  \label{fig:SimMonitor}
\end{figure}

\begin{figure}[htp]
\centering
    \includegraphics[height=0.9\textwidth]{figs/NrDetections_Time_1000.eps}
  \caption{Results from the simulation experiment (1000 iterations) illustrating the probability for break detection in the monitoring period while varying the amount of noise ($\sigma$), magnitude of the simulated break ($m$), and amount of data  available in the monitoring period ($d$). The units of the x and y-axis are noise (i.e., $\sigma$ NDVI of the residuals of the fitted seasonal-trend model on the history period) and probability of detecting a break (i.e., proportion of detected breaks in 1000 iterations). See description of the simulation experiment for more details (Section \ref{sec:Valsim}). }
  \label{fig:SimNr}
\end{figure}

\begin{figure}
\centering
 \subfloat[][] {\label{fig:spatiala} \includegraphics[height=0.55\textwidth]{figs/MedianNDVI_Somalia.eps} } %
 \subfloat[][] {\label{fig:spatialb} \includegraphics[width=0.55\textwidth]{figs/LengthHistoryPeriod_EA.eps} }  \\
 \subfloat[][] {\label{fig:spatialc} \includegraphics[width=0.55\textwidth]{figs/Noise_EA.eps} } %
\subfloat[][] {\label{fig:spatiald} \includegraphics[width=0.55\textwidth]{figs/MagnAbnormalBreak_201012_EA.eps} }
 \caption{Results from the analysis of 16-day MODIS NDVI image time series from February 2000 until July 2011 covering Somalia; (a) median of all NDVI images as a proxy for vegetation cover during the 2000--2011 period, (b) length of the stable history period expressed in years where a shorter length is an indication of a more recent disturbance, (c) spatial variation of the noise level i.e. the standard deviation of the residuals of the stable history model, (d) the magnitude of the detected disturbances in the monitoring period (mid 2010 onwards) where white indicates that no disturbance is detected.  The analysis of (d) was restricted to areas with minimum vegetation cover i.e. median NDVI  2000--2011$> 0.2$ and length of the history period $> 2$ years. Examples for three locations ($\triangle,+$~and~$\diamondsuit$) are shown in Fig.~\ref{fig:realmon}.}
 \label{fig:spatial}
\end{figure}

\begin{figure}[htp]
\centering
    \includegraphics[width=1\textwidth]{figs/tsexampleSOM.eps}
  \caption{
 Results of real-time monitoring approach applied to 16-day MODIS NDVI time series for three locations a, b, and c, corresponding to symbols $+,~\triangle$~and~$\diamondsuit$ shown in Fig.~\ref{fig:spatial}. The period from 2000 until mid 2010, is considered the \emph{history period} and the period after the simulated break is the \emph{monitoring period} (grey background, \textcolor{red} {red dotted line}). The stable history period within the history period (\textcolor{blue} {blue dashed line}) is used to model and predict the normal data variation and enable disturbance detection in the monitoring period (Section~\ref{sec:MonStrucChange}).  A disturbance is detected (\textcolor{OliveGreen} {green line}) in Fig~\ref{fig:spatiala} and \ref{fig:spatialb}.}
 
% In both time series a break (vertical red dashed line in 2006) is detected in the monitoring period (i.e., 2006) while using 2000 until end of 2005 as a history period. A stable history period (blue dots) is automatically detected with the history period. The method is able to deal with time series with data gaps (e.g., after cloud removal) which is illustrated by data gaps within the data analysed and model fit based on the stable history period.

  \label{fig:realmon}
\end{figure}


%% explain the monitoring period
%% the model
%% break
%% etc.
%%, i.e., $\diamondsuit$ (top) and $\triangle$ (bottom) on Fig.~\ref{fig:SpatNoise}, \ref{fig:SpatTimeofChange} and \ref{fig:SpatLStableHist}), situated within the Green Hills study area
%

%%\begin{figure}[htp]
%%\centering
%%    \includegraphics[height=0.6\textwidth]{figs/shorthistoryperiod.eps}
%%  \caption{
%%  Results of real-time monitoring approach applied to 16-day MODIS NDVI time series for a location situated within the Green Hills study area (i.e., the $+$ symbol on Fig.~\ref{fig:SpatNoise}, \ref{fig:SpatTimeofChange} and \ref{fig:SpatLStableHist}). A break (vertical red dashed line in 2006) is detected in the monitoring period (i.e., 2006) while using 2000 until end of 2005 as a history period. A short stable history period (blue dots) is detected within the history period due to an ongoing harvest operation from 2005 onwards. The method is able to deal with time series with data gaps (e.g., after cloud removal) which is illustrated by data gaps within the data analysed and model fit based on the stable history period.}
%%  \label{fig:shorthistory}
%%\end{figure}

\end{document}

% %Examples of real-time change analysis for three locations ($\triangle,+$~and~$\diamondsuit$) are shown in Fig.~\ref{fig:realmonitoring} and \ref{fig:shorthistory}. 
%\begin{figure}[htp]
%\centering
%    \includegraphics[height=0.7\textwidth]{figs/MagnAbnormalBreak_201012_EA.png}
%  \caption{Time of detected changes within the Eastern Africa during the monitoring period (2010--2011), where white indicates that no change is detected.  }
%  \label{fig:SpatTimeofChange}
%\end{figure}

%% I included png format figures - to reduce the filesize - but will submit .eps figures to global change biology!
%\begin{figure}[htp]
%\centering
%    \includegraphics[height=0.7\textwidth]{figs/MedianNDVI_Somalia.png}
%  \caption{Spatial variation of the median 16-day MODIS NDVI image time series from February 2000 until July 2011 covering Somalia as an indicator of average vegetation fractional cover during 2000-2011 period .}
%  \label{fig:MedianNDVI}
%\end{figure}

%%\begin{figure}[htp]
%%\centering
%%    \includegraphics[height=0.7\textwidth]{figs/LengthHistoryPeriod_EA.png}
%%  \caption{Spatial variation of the length the stable history period (expressed in years, i.e., 23 16-day images) within the study area. The length of the history period indicates when in the history period a potential disturbance occurred (e.g., shorter length indicates a more recent disturbance). }
%%  \label{fig:SpatLStableHist}
%%\end{figure}
%%
%%\begin{figure}[htp]
%%\centering
%%    \includegraphics[height=0.7\textwidth]{figs/Noise_EA.png}
%%  \caption{Spatial variation of the noise level (i.e., the standard deviation of the residuals of the stable history model) of Somalia, Eastern Africa. The higher noise levels correspond to the regions with a higher average vegetation cover during the 2000-2011 period as shown in Fig.~\ref{fig:MedianNDVI} refer to simulation results}
%%  \label{fig:SpatNoise}
%%\end{figure}
%%

%\begin{figure}
%\centering
%\includegraphics[width=0.5\textwidth]{figs/MedianNDVI_Somalia.png}
% \includegraphics[width=0.5\textwidth]{figs/LengthHistoryPeriod_EA.png}
% \caption{test}
% \label{fig:spatial}
%\end{figure}

%\begin{figure}
%\centering
%\begin{tabular}{cc}
% \includegraphics[height=0.5\textwidth,clip=]{figs/MedianNDVI_Somalia.png} &
% \includegraphics[height=0.5\textwidth,clip=]{figs/LengthHistoryPeriod_EA.png} \\
% \includegraphics[height=0.5\textwidth,clip=]{figs/Noise_EA.png} &
% \includegraphics[height=0.5\textwidth,clip=]{figs/TimeofAbnormalBreak_2010_EA} 
%%\epsfig{file=figure1.eps,width=0.5\linewidth,clip=} & 
%%\epsfig{file=figure2.eps,width=0.5\linewidth,clip=} \\
%%\epsfig{file=figure3.eps,width=0.5\linewidth,clip=} &
%%\epsfig{file=figure4.eps,width=0.5\linewidth,clip=}
% \label{fig:spatial}
%\end{tabular}
%\end{figure}

